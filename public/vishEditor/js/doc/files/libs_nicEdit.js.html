<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>libs&#x2F;nicEdit.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/VISH.Editor.html">VISH.Editor</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/ViSH.html">ViSH</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: libs&#x2F;nicEdit.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;* NicEdit - Micro Inline WYSIWYG
 * Copyright 2007-2008 Brian Kirchoff
 *
 * NicEdit is distributed under the terms of the MIT license
 * For more information visit http:&#x2F;&#x2F;nicedit.com&#x2F;
 * Do not remove this copyright message
 *&#x2F;


&#x2F;&#x2F;Wysiwyg translation
var getTrans = function(s){
	if ((typeof VISH !== &quot;undefined&quot;)				&amp;&amp;
	   	(typeof VISH.Editor !== &quot;undefined&quot;)		&amp;&amp;
	   	(typeof VISH.Editor.I18n !== &quot;undefined&quot;))	{
		var translate = VISH.Editor.I18n.getTrans(s);
		if(translate!=null){
			return translate;
		}
	}
	return s;
}


var bkExtend = function(){
	var args = arguments;
	if (args.length == 1) args = [this, args[0]];
	for (var prop in args[1]) args[0][prop] = args[1][prop];
	return args[0];
};
function bkClass() { }
bkClass.prototype.construct = function() {};
bkClass.extend = function(def) {
  var classDef = function() {
      if (arguments[0] !== bkClass) { return this.construct.apply(this, arguments); }
  };
  var proto = new this(bkClass);
  bkExtend(proto,def);
  classDef.prototype = proto;
  classDef.extend = this.extend;
  return classDef;
};

var bkElement = bkClass.extend({
	construct : function(elm,d) {
		if(typeof(elm) == &quot;string&quot;) {
			elm = (d || document).createElement(elm);
		}
		elm = $BK(elm);
		return elm;
	},
	
	appendTo : function(elm) {
		elm.appendChild(this);	
		return this;
	},
	
	appendBefore : function(elm) {
		elm.parentNode.insertBefore(this,elm);	
		return this;
	},
	
	addEvent : function(type, fn) {
		bkLib.addEvent(this,type,fn);
		return this;	
	},
	
	setContent : function(c) {
		this.innerHTML = c;
		return this;
	},
	
	pos : function() {
		var curleft = curtop = 0;
		var o = obj = this;
		if (obj.offsetParent) {
			do {
				curleft += obj.offsetLeft;
				curtop += obj.offsetTop;
			} while (obj = obj.offsetParent);
		}
		var b = (!window.opera) ? parseInt(this.getStyle(&#x27;border-width&#x27;) || this.style.border) || 0 : 0;
		return [curleft+b,curtop+b+this.offsetHeight];
	},
	
	noSelect : function() {
		bkLib.noSelect(this);
		return this;
	},
	
	parentTag : function(t) {
		var elm = this;
		 do {
			if(elm &amp;&amp; elm.nodeName &amp;&amp; elm.nodeName.toUpperCase() == t) {
				return elm;
			}
			elm = elm.parentNode;
		} while(elm);
		return false;
	},
	
	hasClass : function(cls) {
		return this.className.match(new RegExp(&#x27;(\\s|^)nicEdit-&#x27;+cls+&#x27;(\\s|$)&#x27;));
	},
	
	addClass : function(cls) {
		if (!this.hasClass(cls)) { this.className += &quot; nicEdit-&quot;+cls };
		return this;
	},
	
	removeClass : function(cls) {
		if (this.hasClass(cls)) {
			this.className = this.className.replace(new RegExp(&#x27;(\\s|^)nicEdit-&#x27;+cls+&#x27;(\\s|$)&#x27;),&#x27; &#x27;);
		}
		return this;
	},

	setStyle : function(st) {
		var elmStyle = this.style;
		for(var itm in st) {
			switch(itm) {
				case &#x27;float&#x27;:
					elmStyle[&#x27;cssFloat&#x27;] = elmStyle[&#x27;styleFloat&#x27;] = st[itm];
					break;
				case &#x27;opacity&#x27;:
					elmStyle.opacity = st[itm];
					elmStyle.filter = &quot;alpha(opacity=&quot; + Math.round(st[itm]*100) + &quot;)&quot;; 
					break;
				case &#x27;className&#x27;:
					this.className = st[itm];
					break;
				default:
					&#x2F;&#x2F;if(document.compatMode || itm != &quot;cursor&quot;) { &#x2F;&#x2F; Nasty Workaround for IE 5.5
						elmStyle[itm] = st[itm];
					&#x2F;&#x2F;}		
			}
		}
		return this;
	},
	
	getStyle : function( cssRule, d ) {
		var doc = (!d) ? document.defaultView : d; 
		if(this.nodeType == 1)
		return (doc &amp;&amp; doc.getComputedStyle) ? doc.getComputedStyle( this, null ).getPropertyValue(cssRule) : this.currentStyle[ bkLib.camelize(cssRule) ];
	},
	
	remove : function() {
		this.parentNode.removeChild(this);
		return this;	
	},
	
	setAttributes : function(at) {
		for(var itm in at) {
			this[itm] = at[itm];
		}
		return this;
	}
});

var bkLib = {
	isMSIE : (navigator.appVersion.indexOf(&quot;MSIE&quot;) != -1),
	
	addEvent : function(obj, type, fn) {
		(obj.addEventListener) ? obj.addEventListener( type, fn, false ) : obj.attachEvent(&quot;on&quot;+type, fn);	
	},
	
	toArray : function(iterable) {
		var length = iterable.length, results = new Array(length);
    	while (length--) { results[length] = iterable[length] };
    	return results;	
	},
	
	noSelect : function(element) {
		if(element.setAttribute &amp;&amp; element.nodeName.toLowerCase() != &#x27;input&#x27; &amp;&amp; element.nodeName.toLowerCase() != &#x27;textarea&#x27;) {
			element.setAttribute(&#x27;unselectable&#x27;,&#x27;on&#x27;);
		}
		for(var i=0;i&lt;element.childNodes.length;i++) {
			bkLib.noSelect(element.childNodes[i]);
		}
	},
	camelize : function(s) {
		return s.replace(&#x2F;\-(.)&#x2F;g, function(m, l){return l.toUpperCase()});
	},
	inArray : function(arr,item) {
	    return (bkLib.search(arr,item) != null);
	},
	search : function(arr,itm) {
		for(var i=0; i &lt; arr.length; i++) {
			if(arr[i] == itm)
				return i;
		}
		return null;	
	},
	cancelEvent : function(e) {
		e = e || window.event;
		if(e.preventDefault &amp;&amp; e.stopPropagation) {
			e.preventDefault();
			e.stopPropagation();
		}
		return false;
	},
	domLoad : [],
	domLoaded : function() {
		if (arguments.callee.done) return;
		arguments.callee.done = true;
		for (i = 0;i &lt; bkLib.domLoad.length;i++) bkLib.domLoad[i]();
	},
	onDomLoaded : function(fireThis) {
		this.domLoad.push(fireThis);
		if (document.addEventListener) {
			document.addEventListener(&quot;DOMContentLoaded&quot;, bkLib.domLoaded, null);
		} else if(bkLib.isMSIE) {
			document.write(&quot;&lt;style&gt;.nicEdit-main p { margin: 0; }&lt;&#x2F;style&gt;&lt;scr&quot;+&quot;ipt id=__ie_onload defer &quot; + ((location.protocol == &quot;https:&quot;) ? &quot;src=&#x27;javascript:void(0)&#x27;&quot; : &quot;src=&#x2F;&#x2F;0&quot;) + &quot;&gt;&lt;\&#x2F;scr&quot;+&quot;ipt&gt;&quot;);
			$BK(&quot;__ie_onload&quot;).onreadystatechange = function() {
			    if (this.readyState == &quot;complete&quot;){bkLib.domLoaded();}
			};
		}
	    window.onload = bkLib.domLoaded;
	}
};

function $BK(elm) {
	if(typeof(elm) == &quot;string&quot;) {
		elm = document.getElementById(elm);
	}
	return (elm &amp;&amp; !elm.appendTo) ? bkExtend(elm,bkElement.prototype) : elm;
}

var bkEvent = {
	addEvent : function(evType, evFunc) {
		if(evFunc) {
			this.eventList = this.eventList || {};
			this.eventList[evType] = this.eventList[evType] || [];
			this.eventList[evType].push(evFunc);
		}
		return this;
	},
	fireEvent : function() {
		var args = bkLib.toArray(arguments), evType = args.shift();
		if(this.eventList &amp;&amp; this.eventList[evType]) {
			for(var i=0;i&lt;this.eventList[evType].length;i++) {
				this.eventList[evType][i].apply(this,args);
			}
		}
	}	
};

function __(s) {
	return s;
}

Function.prototype.closure = function() {
  var __method = this, args = bkLib.toArray(arguments), obj = args.shift();
  return function() { if(typeof(bkLib) != &#x27;undefined&#x27;) { return __method.apply(obj,args.concat(bkLib.toArray(arguments))); } };
}
	
Function.prototype.closureListener = function() {
  	var __method = this, args = bkLib.toArray(arguments), object = args.shift(); 
  	return function(e) { 
  	e = e || window.event;
  	if(e.target) { var target = e.target; } else { var target =  e.srcElement };
	  	return __method.apply(object, [e,target].concat(args) ); 
	};
}		


&#x2F;* START CONFIG *&#x2F;

&#x2F;**
 * Reinit niceEditor config after is loaded.
 * Add icons path.
 *&#x2F;
var nicEditorInit = function(){
	nicEditorConfig = bkClass.extend({
		buttons : {
			&#x27;bold&#x27; : {name : __(&#x27;Click to Bold&#x27;), command : &#x27;Bold&#x27;, tags : [&#x27;B&#x27;,&#x27;STRONG&#x27;], css : {&#x27;font-weight&#x27; : &#x27;bold&#x27;}, key : &#x27;b&#x27;},
			&#x27;italic&#x27; : {name : __(&#x27;Click to Italic&#x27;), command : &#x27;Italic&#x27;, tags : [&#x27;EM&#x27;,&#x27;I&#x27;], css : {&#x27;font-style&#x27; : &#x27;italic&#x27;}, key : &#x27;i&#x27;},
			&#x27;underline&#x27; : {name : __(&#x27;Click to Underline&#x27;), command : &#x27;Underline&#x27;, tags : [&#x27;U&#x27;], css : {&#x27;text-decoration&#x27; : &#x27;underline&#x27;}, key : &#x27;u&#x27;},
			&#x27;left&#x27; : {name : __(&#x27;Left Align&#x27;), command : &#x27;justifyleft&#x27;, noActive : true},
			&#x27;center&#x27; : {name : __(&#x27;Center Align&#x27;), command : &#x27;justifycenter&#x27;, noActive : true},
			&#x27;right&#x27; : {name : __(&#x27;Right Align&#x27;), command : &#x27;justifyright&#x27;, noActive : true},
			&#x27;justify&#x27; : {name : __(&#x27;Justify Align&#x27;), command : &#x27;justifyfull&#x27;, noActive : true},
			&#x27;ol&#x27; : {name : __(&#x27;Insert Ordered List&#x27;), command : &#x27;insertorderedlist&#x27;, tags : [&#x27;OL&#x27;]},
			&#x27;ul&#x27; : 	{name : __(&#x27;Insert Unordered List&#x27;), command : &#x27;insertunorderedlist&#x27;, tags : [&#x27;UL&#x27;]},
			&#x27;subscript&#x27; : {name : __(&#x27;Click to Subscript&#x27;), command : &#x27;subscript&#x27;, tags : [&#x27;SUB&#x27;]},
			&#x27;superscript&#x27; : {name : __(&#x27;Click to Superscript&#x27;), command : &#x27;superscript&#x27;, tags : [&#x27;SUP&#x27;]},
			&#x27;strikethrough&#x27; : {name : __(&#x27;Click to Strike Through&#x27;), command : &#x27;strikeThrough&#x27;, css : {&#x27;text-decoration&#x27; : &#x27;line-through&#x27;}},
			&#x27;removeformat&#x27; : {name : __(&#x27;Remove Formatting&#x27;), command : &#x27;removeformat&#x27;, noActive : true},
			&#x27;indent&#x27; : {name : __(&#x27;Indent Text&#x27;), command : &#x27;indent&#x27;, noActive : true},
			&#x27;outdent&#x27; : {name : __(&#x27;Remove Indent&#x27;), command : &#x27;outdent&#x27;, noActive : true},
			&#x27;hr&#x27; : {name : __(&#x27;Horizontal Rule&#x27;), command : &#x27;insertHorizontalRule&#x27;, noActive : true}
		},
		iconsPath : VISH.ImagesPath + &#x27;nicEditorIcons.gif&#x27;,
		buttonList : [&#x27;save&#x27;,&#x27;bold&#x27;,&#x27;italic&#x27;,&#x27;underline&#x27;,&#x27;left&#x27;,&#x27;center&#x27;,&#x27;right&#x27;,&#x27;justify&#x27;,&#x27;ol&#x27;,&#x27;ul&#x27;,&#x27;fontSize&#x27;,&#x27;fontFamily&#x27;,&#x2F;*&#x27;fontFormat&#x27;,&#x27;indent&#x27;,&#x27;outdent&#x27;,&#x27;image&#x27;,*&#x2F;&#x27;upload&#x27;,&#x27;link&#x27;,&#x27;unlink&#x27;,&#x27;forecolor&#x27;,&#x27;bgcolor&#x27;],
		iconList : {&quot;bgcolor&quot;:1,&quot;forecolor&quot;:2,&quot;bold&quot;:3,&quot;center&quot;:4,&quot;hr&quot;:5,&quot;indent&quot;:6,&quot;italic&quot;:7,&quot;justify&quot;:8,&quot;left&quot;:9,&quot;ol&quot;:10,&quot;outdent&quot;:11,&quot;removeformat&quot;:12,&quot;right&quot;:13,&quot;save&quot;:24,&quot;strikethrough&quot;:15,&quot;subscript&quot;:16,&quot;superscript&quot;:17,&quot;ul&quot;:18,&quot;underline&quot;:19,&quot;image&quot;:20,&quot;link&quot;:21,&quot;unlink&quot;:22,&quot;close&quot;:23,&quot;arrow&quot;:25}
	});
}

var nicEditorConfig = bkClass.extend({
	buttons : {
		&#x27;bold&#x27; : {name : __(&#x27;Click to Bold&#x27;), command : &#x27;Bold&#x27;, tags : [&#x27;B&#x27;,&#x27;STRONG&#x27;], css : {&#x27;font-weight&#x27; : &#x27;bold&#x27;}, key : &#x27;b&#x27;},
		&#x27;italic&#x27; : {name : __(&#x27;Click to Italic&#x27;), command : &#x27;Italic&#x27;, tags : [&#x27;EM&#x27;,&#x27;I&#x27;], css : {&#x27;font-style&#x27; : &#x27;italic&#x27;}, key : &#x27;i&#x27;},
		&#x27;underline&#x27; : {name : __(&#x27;Click to Underline&#x27;), command : &#x27;Underline&#x27;, tags : [&#x27;U&#x27;], css : {&#x27;text-decoration&#x27; : &#x27;underline&#x27;}, key : &#x27;u&#x27;},
		&#x27;left&#x27; : {name : __(&#x27;Left Align&#x27;), command : &#x27;justifyleft&#x27;, noActive : true},
		&#x27;center&#x27; : {name : __(&#x27;Center Align&#x27;), command : &#x27;justifycenter&#x27;, noActive : true},
		&#x27;right&#x27; : {name : __(&#x27;Right Align&#x27;), command : &#x27;justifyright&#x27;, noActive : true},
		&#x27;justify&#x27; : {name : __(&#x27;Justify Align&#x27;), command : &#x27;justifyfull&#x27;, noActive : true},
		&#x27;ol&#x27; : {name : __(&#x27;Insert Ordered List&#x27;), command : &#x27;insertorderedlist&#x27;, tags : [&#x27;OL&#x27;]},
		&#x27;ul&#x27; : 	{name : __(&#x27;Insert Unordered List&#x27;), command : &#x27;insertunorderedlist&#x27;, tags : [&#x27;UL&#x27;]},
		&#x27;subscript&#x27; : {name : __(&#x27;Click to Subscript&#x27;), command : &#x27;subscript&#x27;, tags : [&#x27;SUB&#x27;]},
		&#x27;superscript&#x27; : {name : __(&#x27;Click to Superscript&#x27;), command : &#x27;superscript&#x27;, tags : [&#x27;SUP&#x27;]},
		&#x27;strikethrough&#x27; : {name : __(&#x27;Click to Strike Through&#x27;), command : &#x27;strikeThrough&#x27;, css : {&#x27;text-decoration&#x27; : &#x27;line-through&#x27;}},
		&#x27;removeformat&#x27; : {name : __(&#x27;Remove Formatting&#x27;), command : &#x27;removeformat&#x27;, noActive : true},
		&#x27;indent&#x27; : {name : __(&#x27;Indent Text&#x27;), command : &#x27;indent&#x27;, noActive : true},
		&#x27;outdent&#x27; : {name : __(&#x27;Remove Indent&#x27;), command : &#x27;outdent&#x27;, noActive : true},
		&#x27;hr&#x27; : {name : __(&#x27;Horizontal Rule&#x27;), command : &#x27;insertHorizontalRule&#x27;, noActive : true}
	},
	buttonList : [&#x27;save&#x27;,&#x27;bold&#x27;,&#x27;italic&#x27;,&#x27;underline&#x27;,&#x27;left&#x27;,&#x27;center&#x27;,&#x27;right&#x27;,&#x27;justify&#x27;,&#x27;ol&#x27;,&#x27;ul&#x27;,&#x27;fontSize&#x27;,&#x27;fontFamily&#x27;,&#x2F;*&#x27;fontFormat&#x27;,&#x27;indent&#x27;,&#x27;outdent&#x27;,&#x27;image&#x27;,*&#x2F;&#x27;upload&#x27;,&#x27;link&#x27;,&#x27;unlink&#x27;,&#x27;forecolor&#x27;,&#x27;bgcolor&#x27;],
	iconList : {&quot;bgcolor&quot;:1,&quot;forecolor&quot;:2,&quot;bold&quot;:3,&quot;center&quot;:4,&quot;hr&quot;:5,&quot;indent&quot;:6,&quot;italic&quot;:7,&quot;justify&quot;:8,&quot;left&quot;:9,&quot;ol&quot;:10,&quot;outdent&quot;:11,&quot;removeformat&quot;:12,&quot;right&quot;:13,&quot;save&quot;:24,&quot;strikethrough&quot;:15,&quot;subscript&quot;:16,&quot;superscript&quot;:17,&quot;ul&quot;:18,&quot;underline&quot;:19,&quot;image&quot;:20,&quot;link&quot;:21,&quot;unlink&quot;:22,&quot;close&quot;:23,&quot;arrow&quot;:25}
});

&#x2F;* END CONFIG *&#x2F;


var nicEditors = {
	nicPlugins : [],
	editors : [],
	
	registerPlugin : function(plugin,options) {
		this.nicPlugins.push({p : plugin, o : options});
	},

	allTextAreas : function(nicOptions) {
		var textareas = document.getElementsByTagName(&quot;textarea&quot;);
		for(var i=0;i&lt;textareas.length;i++) {
			nicEditors.editors.push(new nicEditor(nicOptions).panelInstance(textareas[i]));
		}
		return nicEditors.editors;
	},
	
	findEditor : function(e) {
		var editors = nicEditors.editors;
		for(var i=0;i&lt;editors.length;i++) {
			if(editors[i].instanceById(e)) {
				return editors[i].instanceById(e);
			}
		}
	}
};


var nicEditor = bkClass.extend({
	construct : function(o) {
		this.options = new nicEditorConfig();
		bkExtend(this.options,o);
		this.nicInstances = new Array();
		this.loadedPlugins = new Array();
		
		var plugins = nicEditors.nicPlugins;
		for(var i=0;i&lt;plugins.length;i++) {
			this.loadedPlugins.push(new plugins[i].p(this,plugins[i].o));
		}
		nicEditors.editors.push(this);
		bkLib.addEvent(document.body,&#x27;mousedown&#x27;, this.selectCheck.closureListener(this) );
	},
	
	panelInstance : function(e,o) {
		e = this.checkReplace($BK(e));
		var panelElm = new bkElement(&#x27;DIV&#x27;).setStyle({width : (parseInt(e.getStyle(&#x27;width&#x27;)) || e.clientWidth)+&#x27;px&#x27;}).appendBefore(e);
		this.setPanel(panelElm);
		return this.addInstance(e,o);	
	},

	checkReplace : function(e) {
		var r = nicEditors.findEditor(e);
		if(r) {
			r.removeInstance(e);
			r.removePanel();
		}
		return e;
	},

	addInstance : function(e,o) {
		e = this.checkReplace($BK(e));
		if( e.contentEditable || !!window.opera ) {
			var newInstance = new nicEditorInstance(e,o,this);
		} else {
			var newInstance = new nicEditorIFrameInstance(e,o,this);
		}
		this.nicInstances.push(newInstance);
		return this;
	},
	
	removeInstance : function(e) {
		e = $BK(e);
		var instances = this.nicInstances;
		for(var i=0;i&lt;instances.length;i++) {	
			if(instances[i].e == e) {
				instances[i].remove();
				this.nicInstances.splice(i,1);
			}
		}
	},

	removePanel : function(e) {
		if(this.nicPanel) {
			this.nicPanel.remove();
			this.nicPanel = null;
		}	
	},

	instanceById : function(e) {
		e = $BK(e);
		var instances = this.nicInstances;
		for(var i=0;i&lt;instances.length;i++) {
			if(instances[i].e == e) {
				return instances[i];
			}
		}	
	},

	setPanel : function(e) {
		this.nicPanel = new nicEditorPanel($BK(e),this.options,this);
		this.fireEvent(&#x27;panel&#x27;,this.nicPanel);
		return this;
	},
	
	nicCommand : function(cmd,args) {	
		if(this.selectedInstance) {
			this.selectedInstance.nicCommand(cmd,args);
		}
	},
	
	getIcon : function(iconName,options) {
		var icon = this.options.iconList[iconName];
		var file = (options.iconFiles) ? options.iconFiles[iconName] : &#x27;&#x27;;
		return {backgroundImage : &quot;url(&#x27;&quot;+((icon) ? this.options.iconsPath : file)+&quot;&#x27;)&quot;, backgroundPosition : ((icon) ? ((icon-1)*-18) : 0)+&#x27;px 0px&#x27;};	
	},
		
	selectCheck : function(e,t) {
		var found = false;
		do{
			if(t.className &amp;&amp; t.className.indexOf(&#x27;nicEdit&#x27;) != -1) {
				return false;
			}
		} while(t = t.parentNode);
		this.fireEvent(&#x27;blur&#x27;,this.selectedInstance,t);
		this.lastSelectedInstance = this.selectedInstance;
		this.selectedInstance = null;
		return false;
	}
	
});
nicEditor = nicEditor.extend(bkEvent); 


var nicEditorInstance = bkClass.extend({
	isSelected : false,
	construct : function(G, D, C) {
		this.ne = C;
		this.elm = this.e = G;
		this.options = D || {};
		newX = parseInt(G.getStyle(&quot;width&quot;)) || G.clientWidth;
		newY = parseInt(G.getStyle(&quot;height&quot;)) || G.clientHeight;
		this.initialHeight = newY - 8;
		var H = (G.nodeName.toLowerCase() == &quot;textarea&quot;);
		if(H || this.options.hasPanel) {
			var B = (bkLib.isMSIE &amp;&amp; !(( typeof document.body.style.maxHeight != &quot;undefined&quot;) &amp;&amp; document.compatMode == &quot;CSS1Compat&quot;));
			var E = {
				width : newX + &quot;px&quot;,
				border : &quot;1px solid #ccc&quot;,
				borderTop : 0,
				overflowY : &quot;auto&quot;,
				overflowX : &quot;hidden&quot;
			};
			E[(B) ? &quot;height&quot; : &quot;maxHeight&quot;] = (this.ne.options.maxHeight) ? this.ne.options.maxHeight + &quot;px&quot; : null;
			this.editorContain = new bkElement(&quot;DIV&quot;).setStyle(E).appendBefore(G);
			var A = new bkElement(&quot;DIV&quot;).setStyle({
				width : (newX - 8) + &quot;px&quot;,
				margin : &quot;4px&quot;,
				minHeight : newY + &quot;px&quot;
			}).addClass(&quot;main&quot;).appendTo(this.editorContain);
			G.setStyle({
				display : &quot;none&quot;
			});
			A.innerHTML = G.innerHTML;
			if(H) {
				A.setContent(G.value);
				this.copyElm = G;
				var F = G.parentTag(&quot;FORM&quot;);
				if(F) {
					bkLib.addEvent(F, &quot;submit&quot;, this.saveContent.closure(this))
				}
			}
			A.setStyle((B) ? {
				height : newY + &quot;px&quot;
			} : {
				overflow : &quot;hidden&quot;
			});
			this.elm = A
		}
		this.ne.addEvent(&quot;blur&quot;, this.blur.closure(this));
		this.init();
		this.blur()
	},
	init : function() {
		this.elm.setAttribute(&quot;contentEditable&quot;, &quot;true&quot;);
		if(this.getContent() == &quot;&quot;) {
			this.setContent(&quot;&lt;br &#x2F;&gt;&quot;)
		}
		this.instanceDoc = document.defaultView;
		this.elm.addEvent(&quot;mousedown&quot;, this.selected.closureListener(this)).addEvent(&quot;keypress&quot;, this.keyDown.closureListener(this)).addEvent(&quot;focus&quot;, this.selected.closure(this)).addEvent(&quot;blur&quot;, this.blur.closure(this)).addEvent(&quot;keyup&quot;, this.selected.closure(this));
		this.ne.fireEvent(&quot;add&quot;, this)
	},
	remove : function() {
		this.saveContent();
		if(this.copyElm || this.options.hasPanel) {
			this.editorContain.remove();
			this.e.setStyle({
				display : &quot;block&quot;
			});
			this.ne.removePanel()
		}
		this.disable();
		this.ne.fireEvent(&quot;remove&quot;, this)
	},
	disable : function() {
		this.elm.setAttribute(&quot;contentEditable&quot;, &quot;false&quot;)
	},
	getSel : function() {
		return (window.getSelection) ? window.getSelection() : document.selection
	},
	getRng : function() {
		&#x2F;&#x2F;Vish Fix
		var A = this.getSel();

		if(!A) {
	      return null
	    }

	    if((A.rangeCount)&amp;&amp;(A.rangeCount &gt; 0)){
	    	return A.getRangeAt(0);
	    }

	    if(A.createRange) {
	      return A.createRange();
	    }

    	return null;
	},
	selRng : function(A, B) {
		if(window.getSelection) {
			B.removeAllRanges();
			B.addRange(A)
		} else {
			A.select()
		}
	},
	selElm : function() {
		var C = this.getRng();
		
		&#x2F;&#x2F;Vish Fix
		if(!C){
			return null;
		}
		
		if(C.startContainer) {
			var D = C.startContainer;
			if(C.cloneContents().childNodes.length == 1) {
				for(var B = 0; B &lt; D.childNodes.length; B++) {
					var A = D.childNodes[B].ownerDocument.createRange();
					A.selectNode(D.childNodes[B]);
					if(C.compareBoundaryPoints(Range.START_TO_START, A) != 1 &amp;&amp; C.compareBoundaryPoints(Range.END_TO_END, A) != -1) {
						return $BK(D.childNodes[B])
					}
				}
			}
			return $BK(D)
		} else {
			return $BK((this.getSel().type == &quot;Control&quot;) ? C.item(0) : C.parentElement())
		}
	},
	saveRng : function() {
		this.savedRange = this.getRng();
		this.savedSel = this.getSel()
	},
	restoreRng : function() {
		if(this.savedRange) {
			this.selRng(this.savedRange, this.savedSel)
		}
	},
	keyDown : function(B, A) {
		if(B.ctrlKey) {
			this.ne.fireEvent(&quot;key&quot;, this, B)
		}
	},
	selected : function(C, A) {
		if(!A) {
			A = this.selElm()
		}

		if(!C.ctrlKey) {
			var B = this.ne.selectedInstance;
			if(B != this) {
				if(B) {
					this.ne.fireEvent(&quot;blur&quot;, B, A)
				}
				this.ne.selectedInstance = this;
				this.ne.fireEvent(&quot;focus&quot;, B, A)
			}
			this.ne.fireEvent(&quot;selected&quot;, B, A);
			this.isFocused = true;
			this.elm.addClass(&quot;selected&quot;)
		}
		return false
	},
	blur : function() {
		this.isFocused = false;
		this.elm.removeClass(&quot;selected&quot;)
	},
	saveContent : function() {
		if(this.copyElm || this.options.hasPanel) {
			this.ne.fireEvent(&quot;save&quot;, this);
			(this.copyElm) ? this.copyElm.value = this.getContent() : this.e.innerHTML = this.getContent()
		}
	},
	getElm : function() {
		return this.elm
	},
	getContent : function() {
		this.content = this.getElm().innerHTML;
		this.ne.fireEvent(&quot;get&quot;, this);
		return this.content
	},
	setContent : function(A) {
		this.content = A;
		this.ne.fireEvent(&quot;set&quot;, this);
		this.elm.innerHTML = this.content
	},
	nicCommand : function(B, A) {
		document.execCommand(B, false, A)
	}
});



var nicEditorIFrameInstance = nicEditorInstance.extend({
	savedStyles : [],
	
	init : function() {	
		var c = this.elm.innerHTML.replace(&#x2F;^\s+|\s+$&#x2F;g, &#x27;&#x27;);
		this.elm.innerHTML = &#x27;&#x27;;
		(!c) ? c = &quot;&lt;br &#x2F;&gt;&quot; : c;
		this.initialContent = c;
		
		this.elmFrame = new bkElement(&#x27;iframe&#x27;).setAttributes({&#x27;src&#x27; : &#x27;javascript:;&#x27;, &#x27;frameBorder&#x27; : 0, &#x27;allowTransparency&#x27; : &#x27;true&#x27;, &#x27;scrolling&#x27; : &#x27;no&#x27;}).setStyle({height: &#x27;100px&#x27;, width: &#x27;100%&#x27;}).addClass(&#x27;frame&#x27;).appendTo(this.elm);

		if(this.copyElm) { this.elmFrame.setStyle({width : (this.elm.offsetWidth-4)+&#x27;px&#x27;}); }
		
		var styleList = [&#x27;font-size&#x27;,&#x27;font-family&#x27;,&#x27;font-weight&#x27;,&#x27;color&#x27;];
		for(itm in styleList) {
			this.savedStyles[bkLib.camelize(itm)] = this.elm.getStyle(itm);
		}
     	
		setTimeout(this.initFrame.closure(this),50);
	},
	
	disable : function() {
		this.elm.innerHTML = this.getContent();
	},
	
	initFrame : function() {
		var fd = $BK(this.elmFrame.contentWindow.document);
		fd.designMode = &quot;on&quot;;		
		fd.open();
		var css = this.ne.options.externalCSS;
		fd.write(&#x27;&lt;html&gt;&lt;head&gt;&#x27;+((css) ? &#x27;&lt;link href=&quot;&#x27;+css+&#x27;&quot; rel=&quot;stylesheet&quot; type=&quot;text&#x2F;css&quot; &#x2F;&gt;&#x27; : &#x27;&#x27;)+&#x27;&lt;&#x2F;head&gt;&lt;body id=&quot;nicEditContent&quot; style=&quot;margin: 0 !important; background-color: transparent !important;&quot;&gt;&#x27;+this.initialContent+&#x27;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&#x27;);
		fd.close();
		this.frameDoc = fd;

		this.frameWin = $BK(this.elmFrame.contentWindow);
		this.frameContent = $BK(this.frameWin.document.body).setStyle(this.savedStyles);
		this.instanceDoc = this.frameWin.document.defaultView;
		
		this.heightUpdate();
		this.frameDoc.addEvent(&#x27;mousedown&#x27;, this.selected.closureListener(this)).addEvent(&#x27;keyup&#x27;,this.heightUpdate.closureListener(this)).addEvent(&#x27;keydown&#x27;,this.keyDown.closureListener(this)).addEvent(&#x27;keyup&#x27;,this.selected.closure(this));
		this.ne.fireEvent(&#x27;add&#x27;,this);
	},
	
	getElm : function() {
		return this.frameContent;
	},
	
	setContent : function(c) {
		this.content = c;
		this.ne.fireEvent(&#x27;set&#x27;,this);
		this.frameContent.innerHTML = this.content;	
		this.heightUpdate();
	},
	
	getSel : function() {
		return (this.frameWin) ? this.frameWin.getSelection() : this.frameDoc.selection;
	},
	
	heightUpdate : function() {	
		this.elmFrame.style.height = Math.max(this.frameContent.offsetHeight,this.initialHeight)+&#x27;px&#x27;;
	},
    
	nicCommand : function(cmd,args) {
		this.frameDoc.execCommand(cmd,false,args);
		setTimeout(this.heightUpdate.closure(this),100);
	}

	
});
var nicEditorPanel = bkClass.extend({
	construct : function(e,options,nicEditor) {
		this.elm = e;
		this.options = options;
		this.ne = nicEditor;
		this.panelButtons = new Array();
		this.buttonList = bkExtend([],this.ne.options.buttonList);
		
		this.panelContain = new bkElement(&#x27;DIV&#x27;).&#x2F;*setStyle({overflow : &#x27;hidden&#x27;, width : &#x27;100%&#x27;, border : &#x27;1px solid #cccccc&#x27;, backgroundColor : &#x27;#efefef&#x27;}).*&#x2F;addClass(&#x27;panelContain&#x27;);
		this.panelElm = new bkElement(&#x27;DIV&#x27;).&#x2F;*setStyle({margin : &#x27;2px&#x27;, marginTop : &#x27;0px&#x27;, zoom : 1, overflow : &#x27;hidden&#x27;}).*&#x2F;addClass(&#x27;panel&#x27;).appendTo(this.panelContain);
		&#x2F;&#x2F; this.panelContain.appendTo(e);
		&#x2F;&#x2F; Fix to integrate WYSIWYG in toolbar
		this.panelContain.appendTo($(&quot;#toolbar_element&quot;)[0]);

		var opt = this.ne.options;
		var buttons = opt.buttons;
		for(button in buttons) {
				this.addButton(button,opt,true);
		}
		this.reorder();
		if(typeof e.noSelect != &quot;undefined&quot;){
			e.noSelect();
		}	
	},
	
	addButton : function(buttonName,options,noOrder) {
		var button = options.buttons[buttonName];
		var type = (button[&#x27;type&#x27;]) ? eval(&#x27;(typeof(&#x27;+button[&#x27;type&#x27;]+&#x27;) == &quot;undefined&quot;) ? null : &#x27;+button[&#x27;type&#x27;]+&#x27;;&#x27;) : nicEditorButton;
		var hasButton = bkLib.inArray(this.buttonList,buttonName);
		if(type &amp;&amp; (hasButton || this.ne.options.fullPanel)) {
			this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne));
			if(!hasButton) {	
				this.buttonList.push(buttonName);
			}
		}
	},
	
	findButton : function(itm) {
		for(var i=0;i&lt;this.panelButtons.length;i++) {
			if(this.panelButtons[i].name == itm)
				return this.panelButtons[i];
		}	
	},
	
	reorder : function() {
		var bl = this.buttonList;
		for(var i=0;i&lt;bl.length;i++) {
			var button = this.findButton(bl[i]);
			if(button) {
				this.panelElm.appendChild(button.margin);
			}
		}	
	},
	
	remove : function() {
		this.elm.remove();
	}
});
var nicEditorButton = bkClass.extend({
	
	construct : function(e,buttonName,options,nicEditor) {
		this.options = options.buttons[buttonName];
		this.name = buttonName;
		this.ne = nicEditor;
		this.elm = e;

		this.margin = new bkElement(&#x27;DIV&#x27;).setStyle({&#x27;float&#x27; : &#x27;left&#x27;, marginTop : &#x27;2px&#x27;}).appendTo(e);
		this.contain = new bkElement(&#x27;DIV&#x27;).setStyle({width : &#x27;20px&#x27;, height : &#x27;20px&#x27;}).addClass(&#x27;buttonContain&#x27;).appendTo(this.margin);
		this.border = new bkElement(&#x27;DIV&#x27;).setStyle({backgroundColor : &#x27;#efefef&#x27;, border : &#x27;1px solid #efefef&#x27;}).appendTo(this.contain);
		this.button = new bkElement(&#x27;DIV&#x27;).setStyle({width : &#x27;18px&#x27;, height : &#x27;18px&#x27;, overflow : &#x27;hidden&#x27;, zoom : 1, cursor : &#x27;pointer&#x27;}).addClass(&#x27;button&#x27;).setStyle(this.ne.getIcon(buttonName,options)).appendTo(this.border);
		this.button.addEvent(&#x27;mouseover&#x27;, this.hoverOn.closure(this)).addEvent(&#x27;mouseout&#x27;,this.hoverOff.closure(this)).addEvent(&#x27;mousedown&#x27;,this.mouseClick.closure(this)).noSelect();
		
		if(!window.opera) {
			this.button.onmousedown = this.button.onclick = bkLib.cancelEvent;
		}
		
		nicEditor.addEvent(&#x27;selected&#x27;, this.enable.closure(this)).addEvent(&#x27;blur&#x27;, this.disable.closure(this)).addEvent(&#x27;key&#x27;,this.key.closure(this));
		
		this.disable();
		this.init();
	},
	
	init : function() {  },
	
	hide : function() {
		this.contain.setStyle({display : &#x27;none&#x27;});
	},
	
	updateState : function() {
		if(this.isDisabled) { this.setBg(); }
		else if(this.isHover) { this.setBg(&#x27;hover&#x27;); }
		else if(this.isActive) { this.setBg(&#x27;active&#x27;); }
		else { this.setBg(); }
	},
	
	setBg : function(state) {
		switch(state) {
			case &#x27;hover&#x27;:
				var stateStyle = {border : &#x27;1px solid #666&#x27;, backgroundColor : &#x27;#ddd&#x27;};
				break;
			case &#x27;active&#x27;:
				var stateStyle = {border : &#x27;1px solid #666&#x27;, backgroundColor : &#x27;#ccc&#x27;};
				break;
			default:
				var stateStyle = {border : &#x27;1px solid #efefef&#x27;, backgroundColor : &#x27;#efefef&#x27;};	
		}
		this.border.setStyle(stateStyle).addClass(&#x27;button-&#x27;+state);
	},
	
	checkNodes : function(e) {
		
		&#x2F;&#x2F;Vish Fix
		if(!e){
			return;
		}
		
		var elm = e;	
		do {
			if(this.options.tags &amp;&amp; bkLib.inArray(this.options.tags,elm.nodeName)) {
				this.activate();
				return true;
			}
		} while(elm = elm.parentNode &amp;&amp; elm.className != &quot;nicEdit&quot;);
		elm = $BK(e);
		while(elm.nodeType == 3) {
			elm = $BK(elm.parentNode);
		}
		if(this.options.css) {
			for(itm in this.options.css) {
				if(elm.getStyle(itm,this.ne.selectedInstance.instanceDoc) == this.options.css[itm]) {
					this.activate();
					return true;
				}
			}
		}
		this.deactivate();
		return false;
	},
	
	activate : function() {
		if(!this.isDisabled) {
			this.isActive = true;
			this.updateState();	
			this.ne.fireEvent(&#x27;buttonActivate&#x27;,this);
		}
	},
	
	deactivate : function() {
		this.isActive = false;
		this.updateState();	
		if(!this.isDisabled) {
			this.ne.fireEvent(&#x27;buttonDeactivate&#x27;,this);
		}
	},
	
	enable : function(ins,t) {
		this.isDisabled = false;
		this.contain.setStyle({&#x27;opacity&#x27; : 1}).addClass(&#x27;buttonEnabled&#x27;);
		this.updateState();
		this.checkNodes(t);
	},
	
	disable : function(ins,t) {		
		this.isDisabled = true;
		this.contain.setStyle({&#x27;opacity&#x27; : 0.6}).removeClass(&#x27;buttonEnabled&#x27;);
		this.updateState();	
	},
	
	toggleActive : function() {
		(this.isActive) ? this.deactivate() : this.activate();	
	},
	
	hoverOn : function() {
		if(!this.isDisabled) {
			this.isHover = true;
			this.updateState();
			this.ne.fireEvent(&quot;buttonOver&quot;,this);
		}
	}, 
	
	hoverOff : function() {
		this.isHover = false;
		this.updateState();
		this.ne.fireEvent(&quot;buttonOut&quot;,this);
	},
	
	mouseClick : function() {
		if(this.options.command) {
			this.ne.nicCommand(this.options.command,this.options.commandArgs);
			if(!this.options.noActive) {
				this.toggleActive();
			}
		}
		this.ne.fireEvent(&quot;buttonClick&quot;,this);
	},
	
	key : function(nicInstance,e) {
		if(this.options.key &amp;&amp; e.ctrlKey &amp;&amp; String.fromCharCode(e.keyCode || e.charCode).toLowerCase() == this.options.key) {
			this.mouseClick();
			if(e.preventDefault) e.preventDefault();
		}
	}
	
});

 
var nicPlugin = bkClass.extend({
	
	construct : function(nicEditor,options) {
		this.options = options;
		this.ne = nicEditor;
		this.ne.addEvent(&#x27;panel&#x27;,this.loadPanel.closure(this));
		
		this.init();
	},

	loadPanel : function(np) {
		var buttons = this.options.buttons;
		for(var button in buttons) {
			np.addButton(button,this.options);
		}
		np.reorder();
	},

	init : function() {  }
});



 
 &#x2F;* START CONFIG *&#x2F;
var nicPaneOptions = { };
&#x2F;* END CONFIG *&#x2F;

var nicEditorPane = bkClass.extend({
	construct : function(elm,nicEditor,options,openButton) {
		this.ne = nicEditor;
		this.elm = elm;
		this.pos = elm.pos();
		
		this.contain = new bkElement(&#x27;div&#x27;).setStyle({zIndex : &#x27;99999&#x27;, overflow : &#x27;hidden&#x27;, position : &#x27;absolute&#x27;, left : this.pos[0]+&#x27;px&#x27;, top : this.pos[1]+&#x27;px&#x27;})
		this.pane = new bkElement(&#x27;div&#x27;).setStyle({fontSize : &#x27;12px&#x27;, border : &#x27;1px solid #ccc&#x27;, &#x27;overflow&#x27;: &#x27;hidden&#x27;, padding : &#x27;4px&#x27;, textAlign: &#x27;left&#x27;, backgroundColor : &#x27;#ffffc9&#x27;}).addClass(&#x27;pane&#x27;).setStyle(options).appendTo(this.contain);
		
		if(openButton &amp;&amp; !openButton.options.noClose) {
			this.close = new bkElement(&#x27;div&#x27;).setStyle({&#x27;float&#x27; : &#x27;right&#x27;, height: &#x27;16px&#x27;, width : &#x27;16px&#x27;, cursor : &#x27;pointer&#x27;}).setStyle(this.ne.getIcon(&#x27;close&#x27;,nicPaneOptions)).addEvent(&#x27;mousedown&#x27;,openButton.removePane.closure(this)).appendTo(this.pane);
		}
		
		this.contain.noSelect().appendTo(document.body);
		
		this.position();
		this.init();	
	},
	
	init : function() { },
	
	position : function() {
		if(this.ne.nicPanel) {
			var panelElm = this.ne.nicPanel.elm;	
			var panelPos = panelElm.pos();
			var newLeft = panelPos[0]+parseInt(panelElm.getStyle(&#x27;width&#x27;))-(parseInt(this.pane.getStyle(&#x27;width&#x27;))+8);
			if(newLeft &lt; this.pos[0]) {
				this.contain.setStyle({left : newLeft+&#x27;px&#x27;});
			}
		}
	},
	
	toggle : function() {
		this.isVisible = !this.isVisible;
		this.contain.setStyle({display : ((this.isVisible) ? &#x27;block&#x27; : &#x27;none&#x27;)});
	},
	
	remove : function() {
		if(this.contain) {
			this.contain.remove();
			this.contain = null;
		}
	},
	
	append : function(c) {
		c.appendTo(this.pane);
	},
	
	setContent : function(c) {
		this.pane.setContent(c);
	}
	
});


 
var nicEditorAdvancedButton = nicEditorButton.extend({
	
	init : function() {
		this.ne.addEvent(&#x27;selected&#x27;,this.removePane.closure(this)).addEvent(&#x27;blur&#x27;,this.removePane.closure(this));	
	},
	
	mouseClick : function() {
		if(!this.isDisabled) {
			if(this.pane &amp;&amp; this.pane.pane) {
				this.removePane();
			} else {
				this.pane = new nicEditorPane(this.contain,this.ne,{width : (this.width || &#x27;270px&#x27;), backgroundColor : &#x27;#fff&#x27;},this);
				this.addPane();
				this.ne.selectedInstance.saveRng();
			}
		}
	},
	
	addForm : function(f,elm) {
		this.form = new bkElement(&#x27;form&#x27;).addEvent(&#x27;submit&#x27;,this.submit.closureListener(this));
		this.pane.append(this.form);
		this.inputs = {};
		
		for(itm in f) {
			var field = f[itm];
			var val = &#x27;&#x27;;
			if(elm) {
				val = elm.getAttribute(itm);
			}
			if(!val) {
				val = field[&#x27;value&#x27;] || &#x27;&#x27;;
			}
			var type = f[itm].type;
			
			if(type == &#x27;title&#x27;) {
					new bkElement(&#x27;div&#x27;).setContent(field.txt).setStyle({fontSize : &#x27;14px&#x27;, fontWeight: &#x27;bold&#x27;, padding : &#x27;0px&#x27;, margin : &#x27;2px 0&#x27;}).appendTo(this.form);
			} else {
				var contain = new bkElement(&#x27;div&#x27;).setStyle({overflow : &#x27;hidden&#x27;, clear : &#x27;both&#x27;}).appendTo(this.form);
				if(field.txt) {
					new bkElement(&#x27;label&#x27;).setAttributes({&#x27;for&#x27; : itm}).setContent(field.txt).setStyle({margin : &#x27;2px 4px&#x27;, fontSize : &#x27;13px&#x27;, width: &#x27;50px&#x27;, lineHeight : &#x27;20px&#x27;, textAlign : &#x27;right&#x27;, &#x27;float&#x27; : &#x27;left&#x27;}).appendTo(contain);
				}
				
				switch(type) {
					case &#x27;text&#x27;:
						this.inputs[itm] = new bkElement(&#x27;input&#x27;).setAttributes({id : itm, &#x27;value&#x27; : val, &#x27;type&#x27; : &#x27;text&#x27;}).setStyle({margin : &#x27;2px 0&#x27;, fontSize : &#x27;13px&#x27;, &#x27;float&#x27; : &#x27;left&#x27;, height : &#x27;20px&#x27;, border : &#x27;1px solid #ccc&#x27;, overflow : &#x27;hidden&#x27;}).setStyle(field.style).appendTo(contain);
						break;
					case &#x27;select&#x27;:
						this.inputs[itm] = new bkElement(&#x27;select&#x27;).setAttributes({id : itm}).setStyle({border : &#x27;1px solid #ccc&#x27;, &#x27;float&#x27; : &#x27;left&#x27;, margin : &#x27;2px 0&#x27;}).appendTo(contain);
						for(opt in field.options) {
							var o = new bkElement(&#x27;option&#x27;).setAttributes({value : opt, selected : (opt == val) ? &#x27;selected&#x27; : &#x27;&#x27;}).setContent(field.options[opt]).appendTo(this.inputs[itm]);
						}
						break;
					case &#x27;content&#x27;:
						this.inputs[itm] = new bkElement(&#x27;textarea&#x27;).setAttributes({id : itm}).setStyle({border : &#x27;1px solid #ccc&#x27;, &#x27;float&#x27; : &#x27;left&#x27;}).setStyle(field.style).appendTo(contain);
						this.inputs[itm].value = val;
				}	
			}
		}

		new bkElement(&#x27;input&#x27;).setAttributes({value : getTrans(&quot;i.add&quot;) , type : &#x27;submit&#x27;}).setStyle({backgroundColor : &#x27;#efefef&#x27;,border : &#x27;1px solid #ccc&#x27;, margin : &#x27;3px 0&#x27;, &#x27;float&#x27; : &#x27;left&#x27;, &#x27;clear&#x27; : &#x27;both&#x27;}).appendTo(this.form);
		this.form.onsubmit = bkLib.cancelEvent;	
	},
	
	submit : function() { },
	
	findElm : function(tag,attr,val) {
		var list = this.ne.selectedInstance.getElm().getElementsByTagName(tag);
		for(var i=0;i&lt;list.length;i++) {
			if(list[i].getAttribute(attr) == val) {
				return $BK(list[i]);
			}
		}
	},
	
	removePane : function() {
		if(this.pane) {
			this.pane.remove();
			this.pane = null;
			this.ne.selectedInstance.restoreRng();
		}	
	}	
});


var nicButtonTips=bkClass.extend({construct:function(A){this.ne=A;A.addEvent(&quot;buttonOver&quot;,this.show.closure(this)).addEvent(&quot;buttonOut&quot;,this.hide.closure(this))},show:function(A){this.timer=setTimeout(this.create.closure(this,A),400)},create:function(A){this.timer=null;if(!this.pane){this.pane=new nicEditorPane(A.button,this.ne,{fontSize:&quot;12px&quot;,marginTop:&quot;5px&quot;});this.pane.setContent(A.options.name)}},hide:function(A){if(this.timer){clearTimeout(this.timer)}if(this.pane){this.pane=this.pane.remove()}}});nicEditors.registerPlugin(nicButtonTips);


 
 &#x2F;* START CONFIG *&#x2F;
var nicSelectOptions = {
	buttons : {
		&#x27;fontSize&#x27; : {name : __(&#x27;Select Font Size&#x27;), type : &#x27;nicEditorFontSizeSelect&#x27;, command : &#x27;fontsize&#x27;},
		&#x27;fontFamily&#x27; : {name : __(&#x27;Select Font Family&#x27;), type : &#x27;nicEditorFontFamilySelect&#x27;, command : &#x27;fontname&#x27;},
		&#x27;fontFormat&#x27; : {name : __(&#x27;Select Font Format&#x27;), type : &#x27;nicEditorFontFormatSelect&#x27;, command : &#x27;formatBlock&#x27;}
	}
};
&#x2F;* END CONFIG *&#x2F;
var nicEditorSelect = bkClass.extend({
	
	construct : function(e,buttonName,options,nicEditor) {
		this.options = options.buttons[buttonName];
		this.elm = e;
		this.ne = nicEditor;
		this.name = buttonName;
		this.selOptions = new Array();
		
		this.margin = new bkElement(&#x27;div&#x27;).setStyle({&#x27;float&#x27; : &#x27;left&#x27;, margin : &#x27;2px 1px 0 1px&#x27;}).appendTo(this.elm);
		this.contain = new bkElement(&#x27;div&#x27;).setStyle({width: &#x27;90px&#x27;, height : &#x27;20px&#x27;, cursor : &#x27;pointer&#x27;, overflow: &#x27;hidden&#x27;}).addClass(&#x27;selectContain&#x27;).addEvent(&#x27;click&#x27;,this.toggle.closure(this)).appendTo(this.margin);
		this.items = new bkElement(&#x27;div&#x27;).setStyle({overflow : &#x27;hidden&#x27;, zoom : 1, border: &#x27;1px solid #ccc&#x27;, paddingLeft : &#x27;3px&#x27;, backgroundColor : &#x27;#fff&#x27;}).appendTo(this.contain);
		this.control = new bkElement(&#x27;div&#x27;).setStyle({overflow : &#x27;hidden&#x27;, &#x27;float&#x27; : &#x27;right&#x27;, height: &#x27;18px&#x27;, width : &#x27;16px&#x27;}).addClass(&#x27;selectControl&#x27;).setStyle(this.ne.getIcon(&#x27;arrow&#x27;,options)).appendTo(this.items);
		this.txt = new bkElement(&#x27;div&#x27;).setStyle({overflow : &#x27;hidden&#x27;, &#x27;float&#x27; : &#x27;left&#x27;, width : &#x27;66px&#x27;, height : &#x27;14px&#x27;, marginTop : &#x27;1px&#x27;, fontFamily : &#x27;sans-serif&#x27;, textAlign : &#x27;center&#x27;, fontSize : &#x27;12px&#x27;}).addClass(&#x27;selectTxt&#x27;).appendTo(this.items);
		
		if(!window.opera) {
			this.contain.onmousedown = this.control.onmousedown = this.txt.onmousedown = bkLib.cancelEvent;
		}
		
		this.margin.noSelect();
		
		this.ne.addEvent(&#x27;selected&#x27;, this.enable.closure(this)).addEvent(&#x27;blur&#x27;, this.disable.closure(this));
		
		this.disable();
		this.init();
	},
	
	disable : function() {
		this.isDisabled = true;
		this.close();
		this.contain.setStyle({opacity : 0.6});
	},
	
	enable : function(t) {
		this.isDisabled = false;
		this.close();
		this.contain.setStyle({opacity : 1});
	},
	
	setDisplay : function(txt) {
		this.txt.setContent(txt);
	},
	
	toggle : function() {
		if(!this.isDisabled) {
			(this.pane) ? this.close() : this.open();
		}
	},
	
	open : function() {
		this.pane = new nicEditorPane(this.items,this.ne,{width : &#x27;88px&#x27;, padding: &#x27;0px&#x27;, borderTop : 0, borderLeft : &#x27;1px solid #ccc&#x27;, borderRight : &#x27;1px solid #ccc&#x27;, borderBottom : &#x27;0px&#x27;, backgroundColor : &#x27;#fff&#x27;});
		
		for(var i=0;i&lt;this.selOptions.length;i++) {
			var opt = this.selOptions[i];
			var itmContain = new bkElement(&#x27;div&#x27;).setStyle({overflow : &#x27;hidden&#x27;, borderBottom : &#x27;1px solid #ccc&#x27;, width: &#x27;88px&#x27;, textAlign : &#x27;left&#x27;, overflow : &#x27;hidden&#x27;, cursor : &#x27;pointer&#x27;});
			var itm = new bkElement(&#x27;div&#x27;).setStyle({padding : &#x27;0px 4px&#x27;}).setContent(opt[1]).appendTo(itmContain).noSelect();
			itm.addEvent(&#x27;click&#x27;,this.update.closure(this,opt[0])).addEvent(&#x27;mouseover&#x27;,this.over.closure(this,itm)).addEvent(&#x27;mouseout&#x27;,this.out.closure(this,itm)).setAttributes(&#x27;id&#x27;,opt[0]);
			this.pane.append(itmContain);
			if(!window.opera) {
				itm.onmousedown = bkLib.cancelEvent;
			}
		}
	},
	
	close : function() {
		if(this.pane) {
			this.pane = this.pane.remove();
		}	
	},
	
	over : function(opt) {
		opt.setStyle({backgroundColor : &#x27;#ccc&#x27;});			
	},
	
	out : function(opt) {
		opt.setStyle({backgroundColor : &#x27;#fff&#x27;});
	},
	
	
	add : function(k,v) {
		this.selOptions.push(new Array(k,v));	
	},
	
	update : function(elm) {
		this.ne.nicCommand(this.options.command,elm);
		this.close();	
	}
});

var nicEditorFontSizeSelect = nicEditorSelect.extend({
	sel : {1 : &#x27;1&amp;nbsp;(8pt)&#x27;, 2 : &#x27;2&amp;nbsp;(10pt)&#x27;, 3 : &#x27;3&amp;nbsp;(12pt)&#x27;, 4 : &#x27;4&amp;nbsp;(14pt)&#x27;, 5 : &#x27;5&amp;nbsp;(18pt)&#x27;, 6 : &#x27;6&amp;nbsp;(24pt)&#x27;, 7 : &#x27;7&amp;nbsp;(48pt)&#x27;},
	init : function() {
		this.setDisplay(&#x27;Font&amp;nbsp;Size...&#x27;);
		for(itm in this.sel) {
			this.add(itm,&#x27;&lt;font size=&quot;&#x27;+itm+&#x27;&quot;&gt;&#x27;+this.sel[itm]+&#x27;&lt;&#x2F;font&gt;&#x27;);
		}		
	}
});

var nicEditorFontFamilySelect = nicEditorSelect.extend({
	sel : {&#x27;arial&#x27; : &#x27;Arial&#x27;,&#x27;comic sans ms&#x27; : &#x27;Comic Sans&#x27;,&#x27;courier new&#x27; : &#x27;Courier New&#x27;,&#x27;georgia&#x27; : &#x27;Georgia&#x27;, &#x27;helvetica&#x27; : &#x27;Helvetica&#x27;, &#x27;impact&#x27; : &#x27;Impact&#x27;, &#x27;times new roman&#x27; : &#x27;Times&#x27;, &#x27;trebuchet ms&#x27; : &#x27;Trebuchet&#x27;, &#x27;verdana&#x27; : &#x27;Verdana&#x27;},
	
	init : function() {
		this.setDisplay(&#x27;Font&amp;nbsp;Family...&#x27;);
		for(itm in this.sel) {
			this.add(itm,&#x27;&lt;font face=&quot;&#x27;+itm+&#x27;&quot;&gt;&#x27;+this.sel[itm]+&#x27;&lt;&#x2F;font&gt;&#x27;);
		}
	}
});

var nicEditorFontFormatSelect = nicEditorSelect.extend({
		sel : {&#x27;p&#x27; : &#x27;Paragraph&#x27;, &#x27;pre&#x27; : &#x27;Pre&#x27;, &#x27;h6&#x27; : &#x27;Heading&amp;nbsp;6&#x27;, &#x27;h5&#x27; : &#x27;Heading&amp;nbsp;5&#x27;, &#x27;h4&#x27; : &#x27;Heading&amp;nbsp;4&#x27;, &#x27;h3&#x27; : &#x27;Heading&amp;nbsp;3&#x27;, &#x27;h2&#x27; : &#x27;Heading&amp;nbsp;2&#x27;, &#x27;h1&#x27; : &#x27;Heading&amp;nbsp;1&#x27;},
		
	init : function() {
		this.setDisplay(&#x27;Font&amp;nbsp;Format...&#x27;);
		for(itm in this.sel) {
			var tag = itm.toUpperCase();
			this.add(&#x27;&lt;&#x27;+tag+&#x27;&gt;&#x27;,&#x27;&lt;&#x27;+itm+&#x27; style=&quot;padding: 0px; margin: 0px;&quot;&gt;&#x27;+this.sel[itm]+&#x27;&lt;&#x2F;&#x27;+tag+&#x27;&gt;&#x27;);
		}
	}
});

nicEditors.registerPlugin(nicPlugin,nicSelectOptions);



&#x2F;* START CONFIG *&#x2F;
var nicLinkOptions = {
	buttons : {
		&#x27;link&#x27; : {name : &#x27;Add Link&#x27;, type : &#x27;nicLinkButton&#x27;, tags : [&#x27;A&#x27;]},
		&#x27;unlink&#x27; : {name : &#x27;Remove Link&#x27;,  command : &#x27;unlink&#x27;, noActive : true}
	}
};
&#x2F;* END CONFIG *&#x2F;

var nicLinkButton = nicEditorAdvancedButton.extend({	
	addPane : function() {
		this.ln = this.ne.selectedInstance.selElm().parentTag(&#x27;A&#x27;);
		this.addForm({
			&#x27;&#x27; : {type : &#x27;title&#x27;, txt : getTrans(&#x27;i.wysiwyg.addurl&#x27;)},
			&#x27;href&#x27; : {type : &#x27;text&#x27;, txt : &#x27;Url&#x27;, value : &#x27;http:&#x2F;&#x2F;&#x27;, style : {width: &#x27;150px&#x27;}},
			&#x27;title&#x27; : {type : &#x27;text&#x27;, txt : getTrans(&#x27;i.Title&#x27;)}
			&#x2F;&#x2F; &#x27;target&#x27; : {type : &#x27;select&#x27;, txt : &#x27;Open In&#x27;, options : {&#x27;&#x27; : &#x27;Current Window&#x27;, &#x27;_blank&#x27; : &#x27;New Window&#x27;},style : {width : &#x27;100px&#x27;}}
		},this.ln);
	},
	
	submit : function(e) {
		var url = this.inputs[&#x27;href&#x27;].value;
		if(url == &quot;http:&#x2F;&#x2F;&quot; || url == &quot;&quot;) {
			return false;
		}

		var titleParam = (typeof this.inputs[&#x27;title&#x27;].value == &quot;string&quot;)&amp;&amp;((this.inputs[&#x27;title&#x27;].value)!=&quot;&quot;);
		if(titleParam){
			title = this.inputs[&#x27;title&#x27;].value;
		} else {
			title = url;
		}

		this.removePane();
		
		if(!this.ln) {
			var tmp = title;
			&#x2F;&#x2F;Brokes on firefox for new txts
			this.ne.nicCommand(&quot;createlink&quot;,tmp);
			this.ln = this.findElm(&#x27;A&#x27;,&#x27;href&#x27;,tmp);
		}

		var linkTxtParam = (typeof $(this.ln).val() == &quot;string&quot;)&amp;&amp;($(this.ln).val()!=&quot;&quot;);

		if((!titleParam)&amp;&amp;(linkTxtParam)){
			title = $(this.ln).val();
		}

		if(this.ln) {
			this.ln.setAttributes({
				href : url,
				title : title,
				target : &quot;blank_&quot;
			});
		}

		&#x2F;&#x2F; VISH.Debugging.log(this.ln)
	}
});

nicEditors.registerPlugin(nicPlugin,nicLinkOptions);



&#x2F;* START CONFIG *&#x2F;
var nicColorOptions = {
	buttons : {
		&#x27;forecolor&#x27; : {name : __(&#x27;Change Text Color&#x27;), type : &#x27;nicEditorColorButton&#x27;, noClose : true},
		&#x27;bgcolor&#x27; : {name : __(&#x27;Change Background Color&#x27;), type : &#x27;nicEditorBgColorButton&#x27;, noClose : true}
	}
};
&#x2F;* END CONFIG *&#x2F;

var nicEditorColorButton=nicEditorAdvancedButton.extend({
	addPane:function(){
		&#x2F;&#x2F;Modified by KIKE to add our own colors XXX
		var D={0:&quot;transparent&quot;,1:&quot;#ffffff&quot;,2:&quot;#201815&quot;,3:&quot;#BF0310&quot;,4:&quot;#008F44&quot;,5:&quot;#009ADA&quot;,6:&quot;#001C7D&quot;,7:&quot;#BA007C&quot;,8:&quot;#A01127&quot;,9:&quot;#C54832&quot;,10:&quot;#CB6120&quot;,11:&quot;#DB9600&quot;,12:&quot;#E5B449&quot;,13:&quot;#F7EC45&quot;,14:&quot;#DDDC1C&quot;,15:&quot;#A2BD31&quot;,16:&quot;#70A73A&quot;,17:&quot;#4F8E3A&quot;,18:&quot;#326534&quot;,19:&quot;#6EAA6E&quot;,20:&quot;#5EA099&quot;,21:&quot;#75AADB&quot;,22:&quot;#4A72B1&quot;,23:&quot;#002D81&quot;,24:&quot;#001A5A&quot;,25:&quot;#57157D&quot;,26:&quot;#7B047D&quot;,27:&quot;#840E5A&quot;,28:&quot;#B10052&quot;,29:&quot;#BF3276&quot;,30:&quot;#C4BA9E&quot;,31:&quot;#9B897A&quot;,32:&quot;#716858&quot;,33:&quot;#584E40&quot;,34:&quot;#BC9D6C&quot;,35:&quot;#A27F51&quot;,36:&quot;#82613C&quot;,37:&quot;#6D5128&quot;,38:&quot;#5A3F09&quot;,39:&quot;#3B2B16&quot;,40:&quot;#434142&quot;,41:&quot;#5B5B5E&quot;,42:&quot;#717175&quot;,43:&quot;#86858A&quot;,44:&quot;#9A999D&quot;,45:&quot;#ADADB2&quot;,46:&quot;#C2C3C8&quot;,47:&quot;#D7D8DC&quot;,48:&quot;#ECEDEF&quot;};
		var H=new bkElement(&quot;DIV&quot;).setStyle({width:&quot;270px&quot;});
		for(var A in D) {			
					var I = D[A];
					var C = new bkElement(&quot;DIV&quot;).setStyle({
						cursor : &quot;pointer&quot;,
						height : &quot;15px&quot;,
						&quot;float&quot; : &quot;left&quot;
					}).appendTo(H);
					var G = new bkElement(&quot;DIV&quot;).setStyle({
						border : &quot;2px solid &quot; + I
					}).appendTo(C);
					if(I===&quot;transparent&quot;){
						var B = new bkElement(&quot;DIV&quot;).setStyle({
							backgroundImage : &quot;url(&#x27;&quot; + VISH.ImagesPath + &quot;transparent_wysiwyg.png&#x27;)&quot;,
							overflow : &quot;hidden&quot;,
							width : &quot;11px&quot;,
							height : &quot;11px&quot;
						}).addEvent(&quot;click&quot;, this.colorSelect.closure(this, I)).addEvent(&quot;mouseover&quot;, this.on.closure(this, G)).addEvent(&quot;mouseout&quot;, this.off.closure(this, G, I)).setAttributes({&quot;title&quot;:&quot;set color to &quot;+I}).appendTo(G);
					}
					else{
						var B = new bkElement(&quot;DIV&quot;).setStyle({
							backgroundColor : I,
							overflow : &quot;hidden&quot;,
							width : &quot;11px&quot;,
							height : &quot;11px&quot;
						}).addEvent(&quot;click&quot;, this.colorSelect.closure(this, I)).addEvent(&quot;mouseover&quot;, this.on.closure(this, G)).addEvent(&quot;mouseout&quot;, this.off.closure(this, G, I)).setAttributes({&quot;title&quot;:&quot;set color to &quot;+I}).appendTo(G);
					}
					if(!window.opera) {
						C.onmousedown = B.onmousedown = bkLib.cancelEvent
					}				
		}
		this.pane.append(H.noSelect())
},
	colorSelect:function(A){this.ne.nicCommand(&quot;foreColor&quot;,A);this.removePane()},on:function(A){A.setStyle({border:&quot;2px solid #000&quot;})},off:function(A,B){A.setStyle({border:&quot;2px solid &quot;+B})}
});

var nicEditorBgColorButton = nicEditorColorButton.extend({
	colorSelect : function(c) {
		this.ne.nicCommand(&#x27;hiliteColor&#x27;,c);
		this.removePane();
	}	
});

nicEditors.registerPlugin(nicPlugin,nicColorOptions);



&#x2F;* START CONFIG *&#x2F;
var nicImageOptions = {
	buttons : {
		&#x27;image&#x27; : {name : &#x27;Add Image&#x27;, type : &#x27;nicImageButton&#x27;, tags : [&#x27;IMG&#x27;]}
	}
	
};
&#x2F;* END CONFIG *&#x2F;

var nicImageButton = nicEditorAdvancedButton.extend({	
	addPane : function() {
		this.im = this.ne.selectedInstance.selElm().parentTag(&#x27;IMG&#x27;);
		this.addForm({
			&#x27;&#x27; : {type : &#x27;title&#x27;, txt : &#x27;Add&#x2F;Edit Image&#x27;},
			&#x27;src&#x27; : {type : &#x27;text&#x27;, txt : &#x27;URL&#x27;, &#x27;value&#x27; : &#x27;http:&#x2F;&#x2F;&#x27;, style : {width: &#x27;150px&#x27;}},
			&#x27;alt&#x27; : {type : &#x27;text&#x27;, txt : &#x27;Alt Text&#x27;, style : {width: &#x27;100px&#x27;}},
			&#x27;align&#x27; : {type : &#x27;select&#x27;, txt : &#x27;Align&#x27;, options : {none : &#x27;Default&#x27;,&#x27;left&#x27; : &#x27;Left&#x27;, &#x27;right&#x27; : &#x27;Right&#x27;}}
		},this.im);
	},
	
	submit : function(e) {
		var src = this.inputs[&#x27;src&#x27;].value;
		if(src == &quot;&quot; || src == &quot;http:&#x2F;&#x2F;&quot;) {
			&#x2F;&#x2F; alert(&quot;You must enter a Image URL to insert&quot;);
			return false;
		}
		this.removePane();

		if(!this.im) {
			var tmp = &#x27;javascript:nicImTemp();&#x27;;
			this.ne.nicCommand(&quot;insertImage&quot;,tmp);
			this.im = this.findElm(&#x27;IMG&#x27;,&#x27;src&#x27;,tmp);
		}
		if(this.im) {
			this.im.setAttributes({
				src : this.inputs[&#x27;src&#x27;].value,
				alt : this.inputs[&#x27;alt&#x27;].value,
				align : this.inputs[&#x27;align&#x27;].value
			});
		}
	}
});

nicEditors.registerPlugin(nicPlugin,nicImageOptions);




&#x2F;* START CONFIG *&#x2F;
var nicSaveOptions = {
	buttons : {
		&#x27;save&#x27; : {name : __(&#x27;Save this content&#x27;), type : &#x27;nicEditorSaveButton&#x27;}
	}
};
&#x2F;* END CONFIG *&#x2F;

var nicEditorSaveButton = nicEditorButton.extend({
	init : function() {
		if(!this.ne.options.onSave) {
			this.margin.setStyle({&#x27;display&#x27; : &#x27;none&#x27;});
		}
	},
	mouseClick : function() {
		var onSave = this.ne.options.onSave;
		var selectedInstance = this.ne.selectedInstance;
		onSave(selectedInstance.getContent(), selectedInstance.elm.id, selectedInstance);
	}
});

nicEditors.registerPlugin(nicPlugin,nicSaveOptions);


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
